var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,l=(t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,i=(e,t)=>{for(var a in t||(t={}))r.call(t,a)&&l(e,a,t[a]);if(n)for(var a of n(t))s.call(t,a)&&l(e,a,t[a]);return e},c=(e,n)=>t(e,a(n));import{u as o,a as u,c as m,C as d,R as p,b as f,f as y,d as _,e as E,g as b,h as g,i as h,S as v,j as S,k as C,l as w,P as O,H as x}from"./vendor.135354cc.js";var k,T,N="_App_8on9z_1";function I(e,t=1){const a={};return e.environment.surface?a.MCG=4*t:a.AEF=Math.trunc((t+2)/3),e.environment.pressure<.25&&(a.SEA=t),e.environment.pressure>2&&(a.HSE=1),e.environment.gravity<.25&&(a.MGC=1),e.environment.gravity>2.5&&(a.BL=1),e.environment.temperature<-25&&(a.INS=10*t),e.environment.temperature>75&&(a.TSH=1),a}(T=k||(k={})).CORE="CORE",T.STORAGE="STORAGE",T.HABITATION="HABITATION",T.RESOURCES="RESOURCES",T.PRODUCTION="PRODUCTION",T.PLANETARY_PROJECT="PLANETARY_PROJECT",T.CORPORATION_PROJECT="CORPORATION_PROJECT";const P=o;function M(e,t=2){return void 0===e?"undefined":e.toFixed(t)}function A(e){for(const t in e)return!1;return!0}const R=m({name:"worldData",initialState:{fetchState:{},material:{data:{},byCategory:{}},building:{data:{},byType:Object.keys(k).reduce(((e,t)=>c(i({},e),{[t]:[]})),{})},planet:{data:{},bySystem:{},maxResources:{}},system:{data:{},byName:{}}},reducers:{setFetchState(e,t){e.fetchState={};const a=e.fetchState;for(const n of t.payload)a[n.id]=n.timestamp},setMaterials(e,t){e.material={data:{},byCategory:{}};const a=e.material;for(const n of t.payload)a.data[n.id]=n,j(a.byCategory,n.category,n.id)},setBuildings(e,t){e.building={data:{},byType:Object.keys(k).reduce(((e,t)=>c(i({},e),{[t]:[]})),{})};const a=e.building;for(const n of t.payload)a.data[n.id]=n,j(a.byType,n.type,n.id)},setPlanets(e,t){e.planet={data:{},bySystem:{},maxResources:{}};const a=e.planet;for(const n of t.payload){a.data[n.id]=n,j(a.bySystem,n.system,n.id);for(const{material:e,perDay:t}of n.resources)a.maxResources[e]?a.maxResources[e]=Math.max(a.maxResources[e],t):a.maxResources[e]=t}},setSystems(e,t){e.system={data:{},byName:{}};const a=e.system;for(const n of t.payload)a.data[n.id]=n,a.byName[n.name]=n.id}}});function j(e,t,a){e[t]||(e[t]=[]),e[t].push(a)}const{setFetchState:D,setMaterials:F,setBuildings:B,setPlanets:L,setSystems:U}=R.actions,{reducer:q}=R;function G(){return P((e=>e.worldData.material.data))}function H(){return P((e=>e.worldData.planet.data))}function $(){return P((e=>e.worldData.system.data))}var z={container:"_container_1u4f8_1",labelContainer:"_labelContainer_1u4f8_15",label:"_label_1u4f8_15",selected:"_selected_1u4f8_51",indicatorContainer:"_indicatorContainer_1u4f8_67",indicator:"_indicator_1u4f8_67",agricultural_products:"_agricultural_products_1u4f8_121",alloys:"_alloys_1u4f8_129",chemicals:"_chemicals_1u4f8_137",construction_materials:"_construction_materials_1u4f8_145",construction_parts:"_construction_parts_1u4f8_153",construction_prefabs:"_construction_prefabs_1u4f8_161",consumables_basic:"_consumables_basic_1u4f8_169",consumables_luxury:"_consumables_luxury_1u4f8_177",drones:"_drones_1u4f8_185",electronic_devices:"_electronic_devices_1u4f8_193",electronic_parts:"_electronic_parts_1u4f8_201",electronic_pieces:"_electronic_pieces_1u4f8_209",electronic_systems:"_electronic_systems_1u4f8_217",elements:"_elements_1u4f8_225",energy_systems:"_energy_systems_1u4f8_233",fuels:"_fuels_1u4f8_241",gases:"_gases_1u4f8_249",liquids:"_liquids_1u4f8_257",medical_equipment:"_medical_equipment_1u4f8_265",metals:"_metals_1u4f8_273",minerals:"_minerals_1u4f8_281",ores:"_ores_1u4f8_289",plastics:"_plastics_1u4f8_297",ship_engines:"_ship_engines_1u4f8_305",ship_kits:"_ship_kits_1u4f8_313",ship_parts:"_ship_parts_1u4f8_321",ship_shields:"_ship_shields_1u4f8_329",software_components:"_software_components_1u4f8_337",software_systems:"_software_systems_1u4f8_345",software_tools:"_software_tools_1u4f8_353",textiles:"_textiles_1u4f8_361",unit_prefabs:"_unit_prefabs_1u4f8_369",utility:"_utility_1u4f8_377",building:"_building_1u4f8_387",defaultColor:"_defaultColor_1u4f8_397"};function J(e){var t;const a=null==e?void 0:e.replaceAll(" ","_").replaceAll(/\(|\)/g,"");return null!=(t=z[a])?t:z.defaultColor}function W({materialId:e,amount:t,size:a=48,fontFactor:n=.33,isSelected:r=!1,onClick:s}){var l;const i=a,c=G();return p.createElement("div",{className:z.container,style:{}},p.createElement(Q,{label:e,colorClass:J(null==(l=c[e])?void 0:l.category),size:i,fontFactor:n,isSelected:r,onClick:a=>s&&s(e,t)}),t?p.createElement("div",{className:z.indicatorContainer},p.createElement("div",{className:z.indicator},t)):null)}function Q({label:e,size:t=48,fontFactor:a=.33,colorClass:n=z.defaultColor,hoverText:r,isSelected:s=!1,onClick:l,children:i}){const c=r||e,o={height:t,width:t,fontSize:t*a,cursor:l?"pointer":"default"},u=[z.container,n];return s&&u.push(z.selected),p.createElement("div",{className:u.join(" "),style:o,title:c,onClick:e=>l&&l(e)},p.createElement("div",{className:z.labelContainer},p.createElement("span",{className:z.label},e)),i)}var V="_table_15ugv_1",Y="_resourceIndicator_15ugv_49";const X={MINERAL:"🧱",LIQUID:"💧",GASEOUS:"☁️"},Z={Jumps:"#",Planet:"Planet",Fertility:"🌱","Type\nRocky or Gaseous":"🪐",Pressure:"💨",Temperature:"🌡️",Gravity:"⚛️"},K=Object.keys(Z).length,ee=["MCG","AEF","SEA","HSE","INS","TSH","MGC","BL"];function te(){const e=$(),{planets:t,planetsPerSystem:a}=function(){const e=H(),t=$(),a=d.exports.useMemo((()=>{const a=Object.keys(t).reduce(((e,t)=>c(i({},e),{[t]:[]})),{});for(const[t,n]of Object.entries(e))j(a,n.system,t);return a}),[e,t]);return{planets:e,planetsPerSystem:a}}(),n=P((e=>e.worldData.planet.maxResources)),[r,s]=d.exports.useState("OT-580"),[l,o]=d.exports.useState([]),[u,m]=d.exports.useState(!1),[f,y]=d.exports.useState(10),[_,E]=d.exports.useState(["MCG","AEF","SEA"]),[b,g]=d.exports.useState(0),h=d.exports.useMemo((()=>Object.entries({AI1:"ZV-307",CI1:"UV-351",IC1:"VH-331",NC1:"OT-580"}).reduce(((t,[a,n])=>c(i({},t),{[a]:ae(n,e)})),{})),[e]),v=d.exports.useMemo((()=>e[r]?ae(r,e):new Map),[r,e]),S=d.exports.useMemo((()=>{console.time("Evaluate planets");const e=[];for(const[n,r]of v)if(!(f&&r>f))for(const s of a[n]){let a=!0;for(const e of Object.keys(I(t[s])))if(-1!=ee.indexOf(e)&&-1==_.indexOf(e)){a=!1;break}a&&e.push({planet:s,jumps:r})}return console.timeEnd("Evaluate planets"),e.sort(((e,a)=>{const n=(()=>{if(0==b)return e.jumps-a.jumps;if(2==b)return t[a.planet].environment.fertility-t[e.planet].environment.fertility;if(b>=K&&b<K+l.length){let n=function(e){const a=t[e].resources.filter((e=>e.material==r))[0];return a?a.perDay:0};const r=l[b-K];return n(a.planet)-n(e.planet)}{let n=function(e){return r.get(t[e].system)};const r=Object.values(h)[b-(K+l.length+5)];return n(e.planet)-n(a.planet)}})();return 0==n?e.planet.localeCompare(a.planet):n})),e}),[e,a,v,f,_,b,h]);function C(e){-1==l.indexOf(e)?o([...l,e]):o(l.filter((t=>t!=e)))}function w(e){-1==_.indexOf(e)?E([..._,e]):E(_.filter((t=>t!=e)))}function O(e){return 0==e||2==e||e>=K?()=>g(e):()=>{}}function x(e){const t=e.perDay/n[e.material];return p.createElement("div",{style:{justifyContent:"flex-end",alignItems:"flex-end",display:"flex"}},M(e.perDay)+X[e.type],p.createElement("div",{className:Y,style:{background:`linear-gradient(transparent ${100*(1-t)}%, rgb(${255*(1-t)}, ${255*t}, 0) 0%)`}}))}function k(e){return`${e.material}\nType: ${e.type}\nPer day: ${M(e.perDay)}\nUniverse maximum: ${M(100*e.perDay/n[e.material],0)}% of ${M(n[e.material])}`}const T=G(),N=d.exports.useMemo((()=>{const e=Object.keys(n).reduce(((e,t)=>{if(!T[t])return console.error("missing mat",t,T),e;const a=T[t].category;return e[a]||(e[a]=[]),e[a].push(t),e}),{});return Object.keys(e).sort().map((t=>({category:t,materials:e[t].sort()})))}),[T,n]);return p.createElement("div",null,p.createElement("div",{style:{border:"1 solid white"}},"System: ",p.createElement("input",{value:r,onChange:e=>{s(e.target.value)},list:"LIST_systems"}),"Jumps: ",p.createElement("input",{type:"number",value:f,onChange:e=>{if(!e.target.value)return void y(void 0);const t=parseInt(e.target.value,10);t>=0&&t<=100&&y(t)}})),p.createElement("div",{style:{display:"flex",flexWrap:"wrap"}},N.map((e=>e.materials.map((e=>p.createElement("div",{key:e,style:{margin:1}},p.createElement(W,{key:e,materialId:e,size:32,isSelected:-1!=l.indexOf(e),onClick:C})))))).flat(),p.createElement("div",{style:{margin:1,position:"relative"}},p.createElement(Q,{label:"Clear",size:32,colorClass:"",onClick:()=>o([])})),p.createElement("div",{style:{margin:1,position:"relative"}},p.createElement(Q,{label:u?"ALL":"ANY",hoverText:"Toggle filtering any/all selected materials",size:32,colorClass:"",onClick:()=>m(!u)}))),p.createElement("div",{style:{display:"flex",flexWrap:"wrap"}},p.createElement(Q,{label:"🌱",hoverText:"Fertility",size:32}),ee.map((e=>p.createElement("div",{key:e,style:{margin:1}},p.createElement(W,{key:e,materialId:e,size:32,isSelected:-1!=_.indexOf(e),onClick:w}))))),p.createElement("div",null,p.createElement("table",{className:V},p.createElement("thead",null,p.createElement("tr",null,Object.entries(Z).map((([e,t],a)=>p.createElement("th",{key:t,title:e,onClick:O(a)},t+(b==a?"▼":"")))),l.map(((e,t)=>p.createElement("th",{key:e,title:e,onClick:O(K+t)},e+(b==K+t?"▼":"")))),p.createElement("th",{colSpan:5}),Object.keys(h).map(((e,t)=>p.createElement("th",{key:e,onClick:O(K+l.length+5+t)},e+(b==K+l.length+5+t?"▼":"")))))),p.createElement("tbody",null,S.filter((e=>{if(0==l.length)return!0;const a=t[e.planet].resources.map((e=>e.material));for(const t of l)if(-1!=a.indexOf(t)){if(!u)return!0}else if(u)return!1;return u})).map((e=>{const a=t[e.planet],n=Object.keys(I(a));return p.createElement("tr",{key:e.planet},p.createElement("td",null,e.jumps),p.createElement("td",{title:t[e.planet].name},e.planet),p.createElement("td",null,-1==a.environment.fertility?"-":M(30*a.environment.fertility)+"%"),[["MCG","AEF"],["SEA","HSE"],["INS","TSH"],["MGC","BL"]].map((e=>{var t;const a=e.filter((e=>-1!=n.indexOf(e)))[0];return p.createElement("td",{key:e.join(),className:a?J(null==(t=T[a])?void 0:t.category):""},a)})).flat(),l.map((e=>{var t;const n=a.resources.filter((t=>t.material==e)).shift();return n?p.createElement("td",{key:e,className:J(null==(t=T[e])?void 0:t.category),title:k(n)},x(n)):p.createElement("td",{key:e})})),a.resources.filter((e=>-1==l.indexOf(e.material))).sort(((e,t)=>t.perDay-e.perDay)).map((e=>{var t;return p.createElement("td",{key:e.material,className:J(null==(t=T[e.material])?void 0:t.category),style:{textAlign:"right"},title:k(e)},p.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},p.createElement("div",null," ",e.material),x(e)))})).concat(new Array(5).fill(0).map(((e,t)=>p.createElement("td",{key:"filler"+t})))).slice(0,5).flat(),Object.entries(h).map((([a,n])=>p.createElement("td",{key:a},n.get(t[e.planet].system)))))}))))))}function ae(e,t){console.log("calculateSystemDistances",e);const a=new Map;if(a.set(e,0),A(t))return a;let n=[],r=[e];for(;r.length;)for(n=r,r=[];n.length;){const e=n.pop(),s=a.get(e)+1,l=t[e];if(l)for(const t of l.connections)a.has(t)||(a.set(t,s),r.push(t));else console.error("system not found",e,t)}return a}function ne(){return p.createElement("div",null,"Loading Fio Data")}var re,se;(se=re||(re={}))[se.buildings=0]="buildings",se[se.materials=1]="materials",se[se.planets=2]="planets",se[se.systems=3]="systems";function le(e){return"LIST_"+re[e]}const ie={0:()=>ce(P((e=>e.worldData.building.data))),1:()=>ce(G()),2:()=>oe(H()),3:()=>oe($())};function ce(e){return Object.keys(e).map((e=>[e,e]))}function oe(e){return Object.values(e).map((({id:e,name:t})=>[e,t]))}function ue({id:e,list:t}){return p.createElement("datalist",{id:e},t.map((([e,t])=>p.createElement("option",{value:e,key:t},t))))}function me(){const e=Object.keys(re).filter((e=>"number"==typeof re[e])).map((e=>re[e]));return p.createElement(p.Fragment,null,e.map((e=>p.createElement(ue,{key:le(e),id:le(e),list:ie[e]()}))))}const de=f({reducerPath:"api",baseQuery:y({baseUrl:"https://rest.fnar.net"}),endpoints:e=>({fetchPlanets:e.query({query:()=>"/planet/allplanets"}),fetchPlanet:e.query({query:e=>`/planet/${e}`,transformResponse:e=>e.Resources,keepUnusedDataFor:604800}),fetchCXTicker:e.query({query:e=>`/exchange/${e}`}),fetchPrices:e.query({query:()=>"/rain/prices",keepUnusedDataFor:604800}),basecount:e.query({query:()=>"/planet/basecount",keepUnusedDataFor:600}),findCompanyOrders:e.query({query:e=>`/exchange/orders/${e}`,transformResponse:e=>e.map((e=>{const[t,a]=e.Ticker.split("."),n=(e,t)=>e.map((e=>({amount:e.Count,cost:e.Cost}))).sort(((e,a)=>t?a.cost-e.cost:e.cost-a.cost));return{material:t,cx:a,buys:n(e.Buys,!0),sells:n(e.Sells,!1)}})),keepUnusedDataFor:600})})}),pe=(e,t=18e5)=>(a,n)=>e(a,i({pollingInterval:t},n)),fe=pe(de.useBasecountQuery),ye=pe(de.useFindCompanyOrdersQuery);var _e={title:"_title_1w41a_1","bar-group":"_bar-group_1w41a_13","name-label":"_name-label_1w41a_13","value-label":"_value-label_1w41a_27",container:"_container_1w41a_41"};function Ee({data:e,barHeight:t,maxWidth:a,advance:n=10}){const r=Math.min(Math.max(e.value*n,20),a);const s=.5*t;return p.createElement("g",{className:_e["bar-group"]},p.createElement("text",{className:_e["name-label"],x:"-6",y:s,alignmentBaseline:"middle"},e.name),p.createElement("g",null,p.createElement("title",null,e.title),p.createElement("rect",{y:1,width:r,height:t-2,fill:"#348AA7"}),p.createElement("text",{className:_e["value-label"],x:r-8,y:s,alignmentBaseline:"middle"},e.value)))}var be="_tabs_15wbm_11",ge="_header_15wbm_21",he="_tab_15wbm_11",ve="_tabActive_15wbm_77",Se="_toggleIndicator_15wbm_93",Ce="_toggleIndicatorActive_15wbm_107";function we({tabs:e,currentTab:t,setCurrentTab:a}){return p.createElement("div",{className:be},e.map((e=>{var n;const r=e.id==t;return p.createElement("div",{className:ge,key:e.id},p.createElement("a",{className:(r?ve+" ":"")+he,onClick:()=>{a(e.id)}},null!=(n=e.title)?n:e.id),p.createElement("div",{className:(r?Ce+" ":"")+Se}))})))}const Oe=m({name:"mode",initialState:{experimental:!1,dev:!1},reducers:{setExperimentalMode(e,t){e.experimental=t.payload},setDevModeEnabled(e,t){e.dev=t.payload}}}),{setExperimentalMode:xe,setDevModeEnabled:ke}=Oe.actions;function Te(){return P((e=>e.settings.mode.experimental))}function Ne(){return P((e=>e.settings.mode.dev))}var Ie=_({mode:Oe.reducer});const Pe={states:["settings"],namespace:"yapt"},Me=E({reducer:{[de.reducerPath]:de.reducer,worldData:q,settings:Ie},preloadedState:b.load(Pe),middleware:e=>e({immutableCheck:{ignoredPaths:["worldData"]},serializableCheck:{ignoredPaths:["worldData"]}}).concat(de.middleware).concat(b.save(Pe))}),Ae=e=>e.reduce(((e,t)=>c(i({},e),{[t.CommodityTicker]:t.Amount})),{});const Re={name:"materials",id:"id",path:"/material/allmaterials",transform:Le((e=>({id:e.Ticker,name:e.Name,category:e.CategoryName,weight:e.Weight,volume:e.Volume}))),set:e=>Me.dispatch(F(e)),internalIdMapping:{internalId:"MatId",id:"Ticker"}},je={name:"buildings",id:"id",path:"/building/allbuildings",transform:Le((e=>{return{id:e.Ticker,name:e.Name,type:(t=e,"CM"==t.Ticker?k.CORE:"STO"==t.Ticker?k.STORAGE:t.Name.startsWith("planetaryProject")?k.PLANETARY_PROJECT:t.Name.startsWith("corporationProject")?k.CORPORATION_PROJECT:t.Recipes.length?"RESOURCE_EXTRACTION"==t.Expertise&&t.Recipes.filter((e=>0==e.Inputs.length)).length>0?k.RESOURCES:k.PRODUCTION:k.HABITATION),workforceLevel:"Pioneers",costs:Ae(e.BuildingCosts),recipes:e.Recipes.map((e=>({inputs:Ae(e.Inputs),outputs:Ae(e.Outputs),durationMs:e.DurationMs}))),expertise:e.Expertise||void 0,workforce:{Pioneers:e.Pioneers,Settlers:e.Settlers,Technicians:e.Technicians,Engineers:e.Engineers,Scientists:e.Scientists},area:e.AreaCost};var t})),set:e=>Me.dispatch(B(e))},De={name:"systems",id:"id",path:"/systemstars",transform:e=>{const t=e.reduce(((e,t)=>c(i({},e),{[t.SystemId]:t.NaturalId})),{});return e.map((e=>({id:e.NaturalId,name:e.Name,type:e.Type,connections:e.Connections.map((e=>t[e.Connection]))})))},set:e=>Me.dispatch(U(e)),internalIdMapping:{internalId:"SystemId",id:"NaturalId"}},Fe={name:"planets",id:"id",path:"/planet/allplanets/full",transform:(e,t)=>{const[a,n]=t;return e.map((e=>({id:e.PlanetNaturalId,name:e.PlanetName,system:a[e.SystemId],resources:e.Resources.map((e=>({material:n[e.MaterialId],perDay:e.Factor*("GASEOUS"==e.ResourceType?60:70),type:e.ResourceType}))),environment:{surface:e.Surface,fertility:e.Fertility,temperature:e.Temperature,gravity:e.Gravity,pressure:e.Pressure}})))},set:e=>Me.dispatch(L(e)),internalIdMapping:{internalId:"PlanetId",id:"PlanetNaturalId"}},Be={materials:Re,buildings:je,systems:De,planets:Fe};function Le(e){return t=>t.map((t=>e(t)))}async function Ue(){const e=await $e.open(),t=Ge(e,Re),a=Ge(e,je),n=Ge(e,De),r=Ge(e,Fe,[n,t]);await Promise.all([t,a,n,r])}async function qe(e,t,a=[]){return await e.getFetchInfo(t.name)?(t.set(await e.getAll(t.name)),t.internalIdMapping?await e.getIdMap(t.name):void 0):await Ge(e,t,a)}async function Ge(e,t,a=[]){const n=await async function(e){const t=await fetch("https://rest.fnar.net"+e,{headers:{"Content-Type":"application/json",Accept:"application/json"}});return await t.json()}(t.path),r=t.transform(n,(await Promise.all(a)).map((e=>null!=e?e:{}))),s=e.modify(t.name);let l;if(s.putAll(r),t.internalIdMapping){const e=t.internalIdMapping;l=n.reduce(((t,a)=>c(i({},t),{[a[e.internalId]]:a[e.id]})),{}),s.putIdMap(t.name,l)}const o=s.putFetchInfo(t.name);return await s.finish(),t.set(r),Me.dispatch(D([{id:t.name,timestamp:o.toUTCString()}])),l}const He="fetches";class $e{constructor(e){this.db=e}static async open(){return new $e(await new Promise(((e,t)=>{const a=indexedDB.open("worldData",1);a.onupgradeneeded=e=>{const t=a.result;if(e.oldVersion<1){t.createObjectStore(He,{keyPath:"id"}),t.createObjectStore("idMaps");for(const{name:e,id:a}of Object.values(Be))t.createObjectStore(e,{keyPath:a})}},a.onsuccess=()=>e(a.result),a.onerror=t})))}async get(e,t){return await new Promise((a=>{const n=this.db.transaction(e,"readonly"),r=n.objectStore(e).get(t);n.oncomplete=()=>{a(r.result)}}))}async put(e,t,a){await new Promise((n=>{const r=this.db.transaction(e,"readwrite");r.oncomplete=()=>{n()};r.objectStore(e).put(t,a)}))}async getAll(e){return new Promise((t=>{const a=this.db.transaction(e,"readonly").objectStore(e).getAll();a.onsuccess=()=>{t(a.result)}}))}async putAll(e,t){await new Promise((a=>{const n=this.db.transaction(e,"readwrite");n.oncomplete=()=>{a()};const r=n.objectStore(e);for(const e of t)r.put(e)}))}async getFetchInfo(e){return await this.get(He,e)}async putFetchInfo(e){const t=new Date;return await this.put(He,{id:e,timestamp:t}),t}async getIdMap(e){return await this.get("idMaps",e)}async putIdMap(e,t){await this.put("idMaps",t,e)}modify(e){const t=[e,"idMaps",He],a=this.db.transaction(t,"readwrite");return new ze(a,t.map((e=>a.objectStore(e))))}}class ze{constructor(e,t){this.transaction=e,this.stores=t}async finish(){await new Promise((e=>this.transaction.oncomplete=()=>e()))}putAll(e){this.stores[0].clear();for(const t of e)this.stores[0].put(t)}putIdMap(e,t){this.stores[1].put(t,e)}putFetchInfo(e){const t=new Date;return this.stores[2].put({id:e,timestamp:t}),t}}var Je="_table_1vk0y_1",We="_header_1vk0y_17";function Qe(e){const t=Date.now();return e.some((e=>(t-new Date(e.timestamp).getTime())/1e3<300))}function Ve(){const e=P((e=>Object.keys(e.worldData.fetchState).map((t=>({id:t,timestamp:e.worldData.fetchState[t]}))))),[t,a]=d.exports.useState((()=>Qe(e)));return d.exports.useEffect((()=>{const t=setTimeout((()=>{a(Qe(e))}),6e4);return()=>clearTimeout(t)}),[e]),p.createElement(p.Fragment,null,e.map((e=>p.createElement("tr",{key:e.id},p.createElement("td",null,e.id),p.createElement("td",null,new Date(e.timestamp).toLocaleString(void 0,{}))))),p.createElement("tr",null,p.createElement("td",{colSpan:2},p.createElement("button",{onClick:Ue,disabled:t},"Sync Fio Data"))))}var Ye="_allCxOrders_1ve39_1",Xe="_cxOrders_1ve39_13",Ze="_table_1ve39_21",Ke="_orderSell_1ve39_47",et="_orderBuy_1ve39_55",tt="_firstOfMaterial_1ve39_63",at="_summary_1ve39_75";function nt({companyCode:e}){const{data:t,isFetching:a,error:n}=ye(e),r=d.exports.useMemo((()=>t?t.reduce(((e,t)=>(e[t.cx]||(e[t.cx]=[]),e[t.cx].push(t),e)),{}):{}),[t]);if(a)return p.createElement("div",null,"Loading");if(n)return p.createElement("div",null,"Error: ",JSON.stringify(n));const s=Object.keys(r).sort();return p.createElement("div",{className:Ye},s.map((e=>{const t=st(r[e],!0),a=st(r[e],!1);return p.createElement("div",{key:e,className:Xe},e,p.createElement("table",{className:Ze},p.createElement("tbody",null,p.createElement("tr",null,p.createElement("td",null,"Mat"),p.createElement("td",null,"Type"),p.createElement("td",null,"Quantity"),p.createElement("td",null,"Limit"),p.createElement("td",null,"Total")),r[e].map((e=>[...rt(e.material,e.sells,!0),...rt(e.material,e.buys,!1)])).flat(),t>0&&p.createElement("tr",{className:at},p.createElement("td",{colSpan:2},"Total Sales"),p.createElement("td",null),p.createElement("td",{className:Ke,colSpan:2},M(t))),a>0&&p.createElement("tr",{className:t>0?"":at},p.createElement("td",{colSpan:2},"Total Buys"),p.createElement("td",null),p.createElement("td",{className:et,colSpan:2},M(a))))))})).flat())}function rt(e,t,a){const n=a?Ke:et,r=e+(a?"S":"B");return t.map((({amount:t,cost:s},l)=>p.createElement("tr",{key:r+l,className:0==l?tt:""},p.createElement("td",null,e),p.createElement("td",{className:n},a?"SELL":"BUY"),p.createElement("td",null,t),p.createElement("td",{className:n},M(s)),p.createElement("td",{className:n},M(t*s)))))}function st(e,t){return e.reduce(((e,a)=>e+(t?a.sells:a.buys).reduce(((e,{amount:t,cost:a})=>e+t*a),0)),0)}const lt=[{id:"planetsearch",title:"Search planets",content:function(){return e=["material","system","planet"],P((t=>e.every((e=>!A(t.worldData[e].data)))))?p.createElement(te,null):p.createElement(ne,null);var e}},{id:"basecount",title:"Basecount",content:function(){const{data:e,error:t,isFetching:a}=fe(),n=d.exports.useMemo((()=>{const t=[];if(e){const a=e.reduce(((e,{CompanyCode:t,BaseCount:a})=>{var n;const r=null!=(n=e.get(a))?n:[];return r.push(t),e.set(a,r),e}),new Map);for(const[e,n]of a)t.push({baseCount:e,companies:n})}return t.sort(((e,t)=>e.baseCount-t.baseCount)),t}),[e]);if(a)return p.createElement("div",null,"Loading");if(t)return p.createElement("div",null,"Error: ",JSON.stringify(t));[...e].sort(((e,t)=>t.BaseCount-e.BaseCount));const r=n.length>0?n.reduce(((e,t)=>e+t.companies.length),0)/n.length:1,s=Math.trunc(800/r),l=n.map(((e,t)=>p.createElement("g",{key:t,transform:`translate(0, ${30*t})`},p.createElement(Ee,{data:{name:e.baseCount.toString(),value:e.companies.length,title:e.companies.join(" ")},barHeight:30,maxWidth:800,advance:s}))));return p.createElement("svg",{width:820,height:"300"},p.createElement("g",{className:_e.container},p.createElement("text",{className:_e.title,x:"10",y:"30"},"Player bases by count"),p.createElement("g",{className:_e.chart,transform:"translate(15,60)"},l)))}},{id:"find-company-orders",title:"Find Company Orders",content:function(){const[e,t]=d.exports.useState(""),[a,n]=d.exports.useState("");return p.createElement("div",null,p.createElement("form",{onSubmit:t=>{t.preventDefault(),n(e)}},p.createElement("input",{type:"text",name:"company",placeholder:"Company Code",value:e,onChange:e=>t(e.target.value)}),p.createElement("button",{type:"submit"},"Search")),p.createElement("br",null),"Selected: ",a,p.createElement("br",null),""!=a&&p.createElement(nt,{companyCode:a}))},experimental:!0},{id:"settings",title:"⚙️",content:function(){const e=u(),t=Te();let a;Ne()&&(a=p.createElement(p.Fragment,null,p.createElement("tr",null,p.createElement("td",{colSpan:2},p.createElement("label",null,p.createElement("input",{type:"checkbox",checked:!0,onChange:()=>e(ke(!1))}),"Dev Mode active")))));const n={lastTry:Date.now(),count:0};return p.createElement("table",{className:Je},p.createElement("tbody",null,p.createElement("tr",{className:We},p.createElement("td",{colSpan:2},"Fio Data")),p.createElement(Ve,null),p.createElement("tr",{className:We,onClick:function(){const t=Date.now();t-n.lastTry>1e3&&(n.count=0),n.count++,n.lastTry=t,n.count>=5&&e(ke(!0))}},p.createElement("td",{colSpan:2},"Settings")),p.createElement("tr",null,p.createElement("td",{colSpan:2},p.createElement("label",null,p.createElement("input",{type:"checkbox",checked:t,onChange:t=>e(xe(t.target.checked))}),"Experimental Mode"))),a))}}];function it(){const e=Ne(),t=Te(),a=e?lt:lt.filter((e=>!e.hidden)),n=t||e?a:a.filter((e=>!e.experimental)),r=g(),s=h().pathname.substr(1);return p.createElement(p.Fragment,null,p.createElement(me,null),p.createElement("div",{className:N},p.createElement(we,{tabs:n,currentTab:s,setCurrentTab:e=>r.push("/"+e)}),p.createElement(v,null,a.map((e=>{const t=e.content;return p.createElement(S,{key:e.id,exact:!0,path:"/"+e.id},p.createElement(t,null))})),p.createElement(S,{exact:!0,path:"/"},p.createElement(C,{to:"/"+n[0].id})))))}console.time("loading fio data"),async function(){const e=await $e.open(),t=await e.getAll(He);Me.dispatch(D(t.map((e=>({id:e.id,timestamp:e.timestamp.toUTCString()}))))),Object.values(Be).map((e=>e.name));const a=qe(e,Re),n=qe(e,je),r=qe(e,De),s=qe(e,Fe,[r,a]);await Promise.all([a,n,r,s])}().then((()=>console.timeEnd("loading fio data"))),w.render(p.createElement(p.StrictMode,null,p.createElement(O,{store:Me},p.createElement(x,null,p.createElement(it,null)))),document.getElementById("root"));
